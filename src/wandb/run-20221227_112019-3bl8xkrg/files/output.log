Found 27000 files belonging to 10 classes.
Using 21600 files for training.
Found 27000 files belonging to 10 classes.
Using 5400 files for validation.
['AnnualCrop', 'Forest', 'HerbaceousVegetation', 'Highway', 'Industrial', 'Pasture', 'PermanentCrop', 'Residential', 'River', 'SeaLake']
2022-12-27 11:20:21.340666: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:1041] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2022-12-27 11:20:21.367597: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:1041] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2022-12-27 11:20:21.367688: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:1041] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2022-12-27 11:20:21.368372: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX_VNNI FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-27 11:20:21.368753: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:1041] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2022-12-27 11:20:21.368829: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:1041] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2022-12-27 11:20:21.368874: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:1041] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2022-12-27 11:20:21.719448: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:1041] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2022-12-27 11:20:21.719527: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:1041] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2022-12-27 11:20:21.719578: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:1041] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2022-12-27 11:20:21.719633: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1614] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 21506 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6
2022-12-27 11:20:22.852825: I tensorflow/core/common_runtime/executor.cc:1195] [/device:CPU:0] Executor start aborting: INVALID_ARGUMENT: You must feed a value for placeholder tensor 'Placeholder/_0' with dtype string and shape [21600]
	 [[{{node Placeholder/_0}}]]
2022-12-27 11:20:22.853001: I tensorflow/core/common_runtime/executor.cc:1195] [/device:CPU:0] Executor start aborting: INVALID_ARGUMENT: You must feed a value for placeholder tensor 'Placeholder/_4' with dtype int32 and shape [21600]
	 [[{{node Placeholder/_4}}]]
(32, 180, 180, 3)
(32,)
Model: "my-model"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to
==================================================================================================
 input_1 (InputLayer)           [(None, 180, 180, 3  0           []
                                )]
 conv2d (Conv2D)                (None, 180, 180, 12  3584        ['input_1[0][0]']
                                8)
 conv2d_1 (Conv2D)              (None, 180, 180, 12  147584      ['conv2d[0][0]']
                                8)
 batch_normalization (BatchNorm  (None, 180, 180, 12  512        ['conv2d_1[0][0]']
 alization)                     8)
 conv2d_2 (Conv2D)              (None, 180, 180, 12  147584      ['batch_normalization[0][0]']
                                8)
 add (Add)                      (None, 180, 180, 12  0           ['conv2d[0][0]',
                                8)                                'conv2d_2[0][0]']
 re_lu (ReLU)                   (None, 180, 180, 12  0           ['add[0][0]']
                                8)
 batch_normalization_1 (BatchNo  (None, 180, 180, 12  512        ['re_lu[0][0]']
 rmalization)                   8)
 conv2d_3 (Conv2D)              (None, 90, 90, 128)  147584      ['batch_normalization_1[0][0]']
 conv2d_4 (Conv2D)              (None, 90, 90, 64)   73792       ['conv2d_3[0][0]']
 conv2d_5 (Conv2D)              (None, 90, 90, 64)   36928       ['conv2d_4[0][0]']
 batch_normalization_2 (BatchNo  (None, 90, 90, 64)  256         ['conv2d_5[0][0]']
 rmalization)
 conv2d_6 (Conv2D)              (None, 90, 90, 64)   36928       ['batch_normalization_2[0][0]']
 add_1 (Add)                    (None, 90, 90, 64)   0           ['conv2d_4[0][0]',
                                                                  'conv2d_6[0][0]']
 re_lu_1 (ReLU)                 (None, 90, 90, 64)   0           ['add_1[0][0]']
 batch_normalization_3 (BatchNo  (None, 90, 90, 64)  256         ['re_lu_1[0][0]']
 rmalization)
 conv2d_7 (Conv2D)              (None, 45, 45, 64)   36928       ['batch_normalization_3[0][0]']
 conv2d_8 (Conv2D)              (None, 45, 45, 32)   18464       ['conv2d_7[0][0]']
 conv2d_9 (Conv2D)              (None, 45, 45, 32)   9248        ['conv2d_8[0][0]']
 batch_normalization_4 (BatchNo  (None, 45, 45, 32)  128         ['conv2d_9[0][0]']
 rmalization)
 conv2d_10 (Conv2D)             (None, 45, 45, 32)   9248        ['batch_normalization_4[0][0]']
 add_2 (Add)                    (None, 45, 45, 32)   0           ['conv2d_8[0][0]',
                                                                  'conv2d_10[0][0]']
 re_lu_2 (ReLU)                 (None, 45, 45, 32)   0           ['add_2[0][0]']
 batch_normalization_5 (BatchNo  (None, 45, 45, 32)  128         ['re_lu_2[0][0]']
 rmalization)
 conv2d_11 (Conv2D)             (None, 23, 23, 32)   9248        ['batch_normalization_5[0][0]']
 conv2d_12 (Conv2D)             (None, 23, 23, 16)   4624        ['conv2d_11[0][0]']
 conv2d_13 (Conv2D)             (None, 23, 23, 16)   2320        ['conv2d_12[0][0]']
 batch_normalization_6 (BatchNo  (None, 23, 23, 16)  64          ['conv2d_13[0][0]']
 rmalization)
 conv2d_14 (Conv2D)             (None, 23, 23, 16)   2320        ['batch_normalization_6[0][0]']
 add_3 (Add)                    (None, 23, 23, 16)   0           ['conv2d_12[0][0]',
                                                                  'conv2d_14[0][0]']
 re_lu_3 (ReLU)                 (None, 23, 23, 16)   0           ['add_3[0][0]']
 batch_normalization_7 (BatchNo  (None, 23, 23, 16)  64          ['re_lu_3[0][0]']
 rmalization)
 conv2d_15 (Conv2D)             (None, 12, 12, 16)   2320        ['batch_normalization_7[0][0]']
 conv2d_16 (Conv2D)             (None, 12, 12, 8)    1160        ['conv2d_15[0][0]']
 conv2d_17 (Conv2D)             (None, 12, 12, 8)    584         ['conv2d_16[0][0]']
 batch_normalization_8 (BatchNo  (None, 12, 12, 8)   32          ['conv2d_17[0][0]']
 rmalization)
 conv2d_18 (Conv2D)             (None, 12, 12, 8)    584         ['batch_normalization_8[0][0]']
 add_4 (Add)                    (None, 12, 12, 8)    0           ['conv2d_16[0][0]',
                                                                  'conv2d_18[0][0]']
 re_lu_4 (ReLU)                 (None, 12, 12, 8)    0           ['add_4[0][0]']
 batch_normalization_9 (BatchNo  (None, 12, 12, 8)   32          ['re_lu_4[0][0]']
 rmalization)
 flatten (Flatten)              (None, 1152)         0           ['batch_normalization_9[0][0]']
 dense (Dense)                  (None, 10)           11530       ['flatten[0][0]']
==================================================================================================
Total params: 704,546
Trainable params: 703,554
Non-trainable params: 992
__________________________________________________________________________________________________
2022-12-27 11:20:23.369124: I tensorflow/core/common_runtime/executor.cc:1195] [/device:CPU:0] Executor start aborting: INVALID_ARGUMENT: You must feed a value for placeholder tensor 'Placeholder/_4' with dtype int32 and shape [21600]
	 [[{{node Placeholder/_4}}]]
2022-12-27 11:20:23.369289: I tensorflow/core/common_runtime/executor.cc:1195] [/device:CPU:0] Executor start aborting: INVALID_ARGUMENT: You must feed a value for placeholder tensor 'Placeholder/_4' with dtype int32 and shape [21600]
	 [[{{node Placeholder/_4}}]]
Epoch 1/30
[34m[1mwandb[39m[22m: [33mWARNING[39m When using `save_best_only`, ensure that the `filepath` argument contains formatting placeholders like `{epoch:02d}` or `{batch:02d}`. This ensures correct interpretation of the logged artifacts.
2022-12-27 11:20:34.621299: I tensorflow/core/common_runtime/executor.cc:1195] [/device:CPU:0] Executor start aborting: INVALID_ARGUMENT: You must feed a value for placeholder tensor 'Placeholder/_4' with dtype int32 and shape [21600]
	 [[{{node Placeholder/_4}}]]
2022-12-27 11:20:34.621465: I tensorflow/core/common_runtime/executor.cc:1195] [/device:CPU:0] Executor start aborting: INVALID_ARGUMENT: You must feed a value for placeholder tensor 'Placeholder/_4' with dtype int32 and shape [21600]
	 [[{{node Placeholder/_4}}]]
2022-12-27 11:20:36.805302: I tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:428] Loaded cuDNN version 8700
2022-12-27 11:20:37.245121: I tensorflow/tsl/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-27 11:20:38.484869: I tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:637] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
2022-12-27 11:20:38.486434: I tensorflow/compiler/xla/service/service.cc:169] XLA service 0x7f428db8ec90 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-27 11:20:38.486448: I tensorflow/compiler/xla/service/service.cc:177]   StreamExecutor device (0): NVIDIA GeForce RTX 3090, Compute Capability 8.6
2022-12-27 11:20:38.488944: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:268] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-27 11:20:38.530947: I tensorflow/tsl/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-27 11:20:38.562022: I ./tensorflow/compiler/jit/device_compiler.h:180] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
  6/675 [..............................] - ETA: 1:39 - loss: -4.8056 - categorical_accuracy: 0.0833 - binary_crossentropy: -4.8056WARNING:tensorflow:Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0505s vs `on_train_batch_end` time: 0.0819s). Check your callbacks.
















































675/675 [==============================] - ETA: 0s - loss: -51.5312 - categorical_accuracy: 0.1542 - binary_crossentropy: -51.5312
2022-12-27 11:22:22.940122: I tensorflow/core/common_runtime/executor.cc:1195] [/device:CPU:0] Executor start aborting: INVALID_ARGUMENT: You must feed a value for placeholder tensor 'Placeholder/_4' with dtype int32 and shape [5400]
	 [[{{node Placeholder/_4}}]]
2022-12-27 11:22:22.940289: I tensorflow/core/common_runtime/executor.cc:1195] [/device:CPU:0] Executor start aborting: INVALID_ARGUMENT: You must feed a value for placeholder tensor 'Placeholder/_4' with dtype int32 and shape [5400]
	 [[{{node Placeholder/_4}}]]

675/675 [==============================] - ETA: 0s - loss: -51.5312 - categorical_accuracy: 0.1542 - binary_crossentropy: -51.5312INFO:tensorflow:Assets written to: models/assets
INFO:tensorflow:Assets written to: models/assets
[34m[1mwandb[39m[22m: Adding directory to artifact (./models)... Done. 0.0s
675/675 [==============================] - 122s 164ms/step - loss: -51.5312 - categorical_accuracy: 0.1542 - binary_crossentropy: -51.5312 - val_loss: -53.0222 - val_categorical_accuracy: 0.1865 - val_binary_crossentropy: -53.0222
Epoch 2/30














































675/675 [==============================] - ETA: 0s - loss: -52.0477 - categorical_accuracy: 0.1657 - binary_crossentropy: -52.0477
675/675 [==============================] - 105s 155ms/step - loss: -52.0477 - categorical_accuracy: 0.1657 - binary_crossentropy: -52.0477 - val_loss: -53.0222 - val_categorical_accuracy: 0.1698 - val_binary_crossentropy: -53.0222
Epoch 3/30
















































675/675 [==============================] - 105s 156ms/step - loss: -52.0480 - categorical_accuracy: 0.1694 - binary_crossentropy: -52.0480 - val_loss: -53.0222 - val_categorical_accuracy: 0.1700 - val_binary_crossentropy: -53.0222
Epoch 4/30
  2/675 [..............................] - ETA: 1:49 - loss: -54.0871 - categorical_accuracy: 0.2188 - binary_crossentropy: -54.0871















































675/675 [==============================] - 103s 153ms/step - loss: -52.0480 - categorical_accuracy: 0.1662 - binary_crossentropy: -52.0480 - val_loss: -53.0222 - val_categorical_accuracy: 0.1707 - val_binary_crossentropy: -53.0222
Epoch 5/30
  9/675 [..............................] - ETA: 1:29 - loss: -50.0895 - categorical_accuracy: 0.1840 - binary_crossentropy: -50.0895















































675/675 [==============================] - 104s 153ms/step - loss: -52.0476 - categorical_accuracy: 0.1521 - binary_crossentropy: -52.0476 - val_loss: -53.0222 - val_categorical_accuracy: 0.0763 - val_binary_crossentropy: -53.0222
Epoch 6/30
 13/675 [..............................] - ETA: 1:37 - loss: -51.4662 - categorical_accuracy: 0.0745 - binary_crossentropy: -51.4662

















245/675 [=========>....................] - ETA: 1:01 - loss: -52.6254 - categorical_accuracy: 0.0712 - binary_crossentropy: -52.6254Model: "my-model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #
=================================================================
 input_2 (InputLayer)        [(None, 180, 180, 3)]     0
 conv2d_19 (Conv2D)          (None, 180, 180, 128)     3584
 conv2d_20 (Conv2D)          (None, 180, 180, 128)     147584
 conv2d_21 (Conv2D)          (None, 90, 90, 128)       147584
 conv2d_22 (Conv2D)          (None, 90, 90, 64)        73792
 conv2d_23 (Conv2D)          (None, 90, 90, 64)        36928
 conv2d_24 (Conv2D)          (None, 45, 45, 64)        36928
 conv2d_25 (Conv2D)          (None, 45, 45, 32)        18464
 conv2d_26 (Conv2D)          (None, 45, 45, 32)        9248
 conv2d_27 (Conv2D)          (None, 45, 45, 32)        9248
 conv2d_28 (Conv2D)          (None, 23, 23, 32)        9248
 conv2d_29 (Conv2D)          (None, 23, 23, 16)        4624
 conv2d_30 (Conv2D)          (None, 23, 23, 16)        2320
 conv2d_31 (Conv2D)          (None, 23, 23, 16)        2320
 conv2d_32 (Conv2D)          (None, 12, 12, 16)        2320
 conv2d_33 (Conv2D)          (None, 12, 12, 8)         1160
 conv2d_34 (Conv2D)          (None, 12, 12, 8)         584
 conv2d_35 (Conv2D)          (None, 12, 12, 8)         584
 flatten_1 (Flatten)         (None, 1152)              0
 dense_1 (Dense)             (None, 10)                11530
=================================================================
Total params: 518,050
Trainable params: 518,050
Non-trainable params: 0
_________________________________________________________________
Epoch 1/30
  6/675 [..............................] - ETA: 57s - loss: 9.0902 - categorical_accuracy: 0.8229 - binary_crossentropy: 9.0902  WARNING:tensorflow:Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0283s vs `on_train_batch_end` time: 0.0483s). Check your callbacks.
 14/675 [..............................] - ETA: 56s - loss: -18.0637 - categorical_accuracy: 0.9129 - binary_crossentropy: -18.0637



























675/675 [==============================] - ETA: 0s - loss: -39.6400 - categorical_accuracy: 0.9939 - binary_crossentropy: -39.6400
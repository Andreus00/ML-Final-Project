Found 27000 files belonging to 10 classes.
Using 21600 files for training.
Found 27000 files belonging to 10 classes.
Using 5400 files for validation.
['AnnualCrop', 'Forest', 'HerbaceousVegetation', 'Highway', 'Industrial', 'Pasture', 'PermanentCrop', 'Residential', 'River', 'SeaLake']
2022-12-27 12:59:32.847006: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:1041] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2022-12-27 12:59:32.874861: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:1041] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2022-12-27 12:59:32.874956: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:1041] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2022-12-27 12:59:32.875396: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX_VNNI FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-12-27 12:59:32.875761: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:1041] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2022-12-27 12:59:32.875830: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:1041] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2022-12-27 12:59:32.875875: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:1041] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2022-12-27 12:59:33.284366: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:1041] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2022-12-27 12:59:33.284444: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:1041] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2022-12-27 12:59:33.284495: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:1041] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2022-12-27 12:59:33.284549: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1614] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 21511 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6
2022-12-27 12:59:34.290510: I tensorflow/core/common_runtime/executor.cc:1195] [/device:CPU:0] Executor start aborting: INVALID_ARGUMENT: You must feed a value for placeholder tensor 'Placeholder/_4' with dtype int32 and shape [21600]
	 [[{{node Placeholder/_4}}]]
2022-12-27 12:59:34.290683: I tensorflow/core/common_runtime/executor.cc:1195] [/device:CPU:0] Executor start aborting: INVALID_ARGUMENT: You must feed a value for placeholder tensor 'Placeholder/_4' with dtype int32 and shape [21600]
	 [[{{node Placeholder/_4}}]]
2022-12-27 12:59:34.740867: I tensorflow/core/common_runtime/executor.cc:1195] [/device:CPU:0] Executor start aborting: INVALID_ARGUMENT: You must feed a value for placeholder tensor 'Placeholder/_4' with dtype int32 and shape [21600]
	 [[{{node Placeholder/_4}}]]
2022-12-27 12:59:34.741037: I tensorflow/core/common_runtime/executor.cc:1195] [/device:CPU:0] Executor start aborting: INVALID_ARGUMENT: You must feed a value for placeholder tensor 'Placeholder/_0' with dtype string and shape [21600]
	 [[{{node Placeholder/_0}}]]
(32, 180, 180, 3)
(32,)
Model: "my-model"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to
==================================================================================================
 input_1 (InputLayer)           [(None, 180, 180, 3  0           []
                                )]
 conv2d (Conv2D)                (None, 180, 180, 12  3584        ['input_1[0][0]']
                                8)
 re_lu (ReLU)                   (None, 180, 180, 12  0           ['conv2d[0][0]']
                                8)
 conv2d_1 (Conv2D)              (None, 180, 180, 12  147584      ['re_lu[0][0]']
                                8)
 re_lu_1 (ReLU)                 (None, 180, 180, 12  0           ['conv2d_1[0][0]']
                                8)
 conv2d_2 (Conv2D)              (None, 180, 180, 12  147584      ['re_lu_1[0][0]']
                                8)
 batch_normalization (BatchNorm  (None, 180, 180, 12  512        ['conv2d_2[0][0]']
 alization)                     8)
 conv2d_3 (Conv2D)              (None, 180, 180, 12  147584      ['batch_normalization[0][0]']
                                8)
 add (Add)                      (None, 180, 180, 12  0           ['re_lu_1[0][0]',
                                8)                                'conv2d_3[0][0]']
 re_lu_2 (ReLU)                 (None, 180, 180, 12  0           ['add[0][0]']
                                8)
 batch_normalization_1 (BatchNo  (None, 180, 180, 12  512        ['re_lu_2[0][0]']
 rmalization)                   8)
 conv2d_4 (Conv2D)              (None, 90, 90, 128)  147584      ['batch_normalization_1[0][0]']
 conv2d_5 (Conv2D)              (None, 90, 90, 64)   73792       ['conv2d_4[0][0]']
 re_lu_3 (ReLU)                 (None, 90, 90, 64)   0           ['conv2d_5[0][0]']
 conv2d_6 (Conv2D)              (None, 90, 90, 64)   36928       ['re_lu_3[0][0]']
 re_lu_4 (ReLU)                 (None, 90, 90, 64)   0           ['conv2d_6[0][0]']
 conv2d_7 (Conv2D)              (None, 90, 90, 64)   36928       ['re_lu_4[0][0]']
 batch_normalization_2 (BatchNo  (None, 90, 90, 64)  256         ['conv2d_7[0][0]']
 rmalization)
 conv2d_8 (Conv2D)              (None, 90, 90, 64)   36928       ['batch_normalization_2[0][0]']
 add_1 (Add)                    (None, 90, 90, 64)   0           ['re_lu_4[0][0]',
                                                                  'conv2d_8[0][0]']
 re_lu_5 (ReLU)                 (None, 90, 90, 64)   0           ['add_1[0][0]']
 batch_normalization_3 (BatchNo  (None, 90, 90, 64)  256         ['re_lu_5[0][0]']
 rmalization)
 conv2d_9 (Conv2D)              (None, 45, 45, 64)   36928       ['batch_normalization_3[0][0]']
 conv2d_10 (Conv2D)             (None, 45, 45, 32)   18464       ['conv2d_9[0][0]']
 re_lu_6 (ReLU)                 (None, 45, 45, 32)   0           ['conv2d_10[0][0]']
 conv2d_11 (Conv2D)             (None, 45, 45, 32)   9248        ['re_lu_6[0][0]']
 re_lu_7 (ReLU)                 (None, 45, 45, 32)   0           ['conv2d_11[0][0]']
 conv2d_12 (Conv2D)             (None, 45, 45, 32)   9248        ['re_lu_7[0][0]']
 re_lu_8 (ReLU)                 (None, 45, 45, 32)   0           ['conv2d_12[0][0]']
 conv2d_13 (Conv2D)             (None, 45, 45, 32)   9248        ['re_lu_8[0][0]']
 batch_normalization_4 (BatchNo  (None, 45, 45, 32)  128         ['conv2d_13[0][0]']
 rmalization)
 conv2d_14 (Conv2D)             (None, 45, 45, 32)   9248        ['batch_normalization_4[0][0]']
 add_2 (Add)                    (None, 45, 45, 32)   0           ['re_lu_8[0][0]',
                                                                  'conv2d_14[0][0]']
 re_lu_9 (ReLU)                 (None, 45, 45, 32)   0           ['add_2[0][0]']
 batch_normalization_5 (BatchNo  (None, 45, 45, 32)  128         ['re_lu_9[0][0]']
 rmalization)
 conv2d_15 (Conv2D)             (None, 23, 23, 32)   9248        ['batch_normalization_5[0][0]']
 conv2d_16 (Conv2D)             (None, 23, 23, 16)   4624        ['conv2d_15[0][0]']
 re_lu_10 (ReLU)                (None, 23, 23, 16)   0           ['conv2d_16[0][0]']
 conv2d_17 (Conv2D)             (None, 23, 23, 16)   2320        ['re_lu_10[0][0]']
 re_lu_11 (ReLU)                (None, 23, 23, 16)   0           ['conv2d_17[0][0]']
 conv2d_18 (Conv2D)             (None, 23, 23, 16)   2320        ['re_lu_11[0][0]']
 re_lu_12 (ReLU)                (None, 23, 23, 16)   0           ['conv2d_18[0][0]']
 conv2d_19 (Conv2D)             (None, 23, 23, 16)   2320        ['re_lu_12[0][0]']
 batch_normalization_6 (BatchNo  (None, 23, 23, 16)  64          ['conv2d_19[0][0]']
 rmalization)
 conv2d_20 (Conv2D)             (None, 23, 23, 16)   2320        ['batch_normalization_6[0][0]']
 add_3 (Add)                    (None, 23, 23, 16)   0           ['re_lu_12[0][0]',
                                                                  'conv2d_20[0][0]']
 re_lu_13 (ReLU)                (None, 23, 23, 16)   0           ['add_3[0][0]']
 batch_normalization_7 (BatchNo  (None, 23, 23, 16)  64          ['re_lu_13[0][0]']
 rmalization)
 conv2d_21 (Conv2D)             (None, 12, 12, 16)   2320        ['batch_normalization_7[0][0]']
 conv2d_22 (Conv2D)             (None, 12, 12, 8)    1160        ['conv2d_21[0][0]']
 re_lu_14 (ReLU)                (None, 12, 12, 8)    0           ['conv2d_22[0][0]']
 conv2d_23 (Conv2D)             (None, 12, 12, 8)    584         ['re_lu_14[0][0]']
 re_lu_15 (ReLU)                (None, 12, 12, 8)    0           ['conv2d_23[0][0]']
 conv2d_24 (Conv2D)             (None, 12, 12, 8)    584         ['re_lu_15[0][0]']
 re_lu_16 (ReLU)                (None, 12, 12, 8)    0           ['conv2d_24[0][0]']
 conv2d_25 (Conv2D)             (None, 12, 12, 8)    584         ['re_lu_16[0][0]']
 batch_normalization_8 (BatchNo  (None, 12, 12, 8)   32          ['conv2d_25[0][0]']
 rmalization)
 conv2d_26 (Conv2D)             (None, 12, 12, 8)    584         ['batch_normalization_8[0][0]']
 add_4 (Add)                    (None, 12, 12, 8)    0           ['re_lu_16[0][0]',
                                                                  'conv2d_26[0][0]']
 re_lu_17 (ReLU)                (None, 12, 12, 8)    0           ['add_4[0][0]']
 batch_normalization_9 (BatchNo  (None, 12, 12, 8)   32          ['re_lu_17[0][0]']
 rmalization)
 flatten (Flatten)              (None, 1152)         0           ['batch_normalization_9[0][0]']
 dense (Dense)                  (None, 10)           11530       ['flatten[0][0]']
==================================================================================================
Total params: 913,362
Trainable params: 912,370
Non-trainable params: 992
__________________________________________________________________________________________________
Epoch 1/4
2022-12-27 12:59:35.291416: I tensorflow/core/common_runtime/executor.cc:1195] [/device:CPU:0] Executor start aborting: INVALID_ARGUMENT: You must feed a value for placeholder tensor 'Placeholder/_4' with dtype int32 and shape [5400]
	 [[{{node Placeholder/_4}}]]
2022-12-27 12:59:35.291579: I tensorflow/core/common_runtime/executor.cc:1195] [/device:CPU:0] Executor start aborting: INVALID_ARGUMENT: You must feed a value for placeholder tensor 'Placeholder/_4' with dtype int32 and shape [5400]
	 [[{{node Placeholder/_4}}]]
[34m[1mwandb[39m[22m: [33mWARNING[39m When using `save_best_only`, ensure that the `filepath` argument contains formatting placeholders like `{epoch:02d}` or `{batch:02d}`. This ensures correct interpretation of the logged artifacts.
2022-12-27 12:59:35.648079: I tensorflow/core/common_runtime/executor.cc:1195] [/device:CPU:0] Executor start aborting: INVALID_ARGUMENT: You must feed a value for placeholder tensor 'Placeholder/_4' with dtype int32 and shape [21600]
	 [[{{node Placeholder/_4}}]]
2022-12-27 12:59:35.648242: I tensorflow/core/common_runtime/executor.cc:1195] [/device:CPU:0] Executor start aborting: INVALID_ARGUMENT: You must feed a value for placeholder tensor 'Placeholder/_0' with dtype string and shape [21600]
	 [[{{node Placeholder/_0}}]]
2022-12-27 12:59:38.335914: I tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:428] Loaded cuDNN version 8700
2022-12-27 12:59:38.792069: I tensorflow/tsl/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-27 12:59:40.012784: I tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:637] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
2022-12-27 12:59:40.015742: I tensorflow/compiler/xla/service/service.cc:169] XLA service 0x1fe8a010 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-12-27 12:59:40.015769: I tensorflow/compiler/xla/service/service.cc:177]   StreamExecutor device (0): NVIDIA GeForce RTX 3090, Compute Capability 8.6
2022-12-27 12:59:40.020142: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:268] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2022-12-27 12:59:40.064665: I tensorflow/tsl/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2022-12-27 12:59:40.095074: I ./tensorflow/compiler/jit/device_compiler.h:180] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
  6/675 [..............................] - ETA: 2:13 - loss: 0.6517 - binary_crossentropy: 0.6517 - categorical_accuracy: 0.1042WARNING:tensorflow:Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0680s vs `on_train_batch_end` time: 0.1096s). Check your callbacks.

































































675/675 [==============================] - ETA: 0s - loss: 0.2368 - binary_crossentropy: 0.2368 - categorical_accuracy: 0.4487
WARNING:absl:Found untraced functions such as _jit_compiled_convolution_op, _jit_compiled_convolution_op, _jit_compiled_convolution_op, _jit_compiled_convolution_op, _jit_compiled_convolution_op while saving (showing 5 of 27). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: models/assets

675/675 [==============================] - ETA: 0s - loss: 0.2368 - binary_crossentropy: 0.2368 - categorical_accuracy: 0.4487INFO:tensorflow:Assets written to: models/assets
675/675 [==============================] - 162s 221ms/step - loss: 0.2368 - binary_crossentropy: 0.2368 - categorical_accuracy: 0.4487 - val_loss: 0.2980 - val_binary_crossentropy: 0.2980 - val_categorical_accuracy: 0.3956
Epoch 2/4






























































675/675 [==============================] - ETA: 0s - loss: 0.1714 - binary_crossentropy: 0.1714 - categorical_accuracy: 0.6320INFO:tensorflow:Assets written to: models/assets
WARNING:absl:Found untraced functions such as _jit_compiled_convolution_op, _jit_compiled_convolution_op, _jit_compiled_convolution_op, _jit_compiled_convolution_op, _jit_compiled_convolution_op while saving (showing 5 of 27). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: models/assets
[34m[1mwandb[39m[22m: Adding directory to artifact (./models)... Done. 0.0s
675/675 [==============================] - 144s 213ms/step - loss: 0.1714 - binary_crossentropy: 0.1714 - categorical_accuracy: 0.6320 - val_loss: 0.1754 - val_binary_crossentropy: 0.1754 - val_categorical_accuracy: 0.6107
Epoch 3/4
































































675/675 [==============================] - ETA: 0s - loss: 0.1442 - binary_crossentropy: 0.1442 - categorical_accuracy: 0.6981
675/675 [==============================] - 143s 212ms/step - loss: 0.1442 - binary_crossentropy: 0.1442 - categorical_accuracy: 0.6981 - val_loss: 0.4993 - val_binary_crossentropy: 0.4993 - val_categorical_accuracy: 0.3339
Epoch 4/4































































675/675 [==============================] - 140s 207ms/step - loss: 0.1273 - binary_crossentropy: 0.1273 - categorical_accuracy: 0.7407 - val_loss: 0.2659 - val_binary_crossentropy: 0.2659 - val_categorical_accuracy: 0.5102
 12/169 [=>............................] - ETA: 11s - loss: 0.3023 - binary_crossentropy: 0.3023 - categorical_accuracy: 0.4479





169/169 [==============================] - 13s 75ms/step - loss: 0.2659 - binary_crossentropy: 0.2659 - categorical_accuracy: 0.5102
[0.2658883035182953, 0.2658883035182953, 0.510185182094574]






169/169 [==============================] - 13s 74ms/step
[9.8542655e-01 1.9334310e-07 6.1000569e-04 9.9008726e-03 7.3525895e-05
 4.9789373e-06 2.4159050e-03 4.8732727e-07 1.9889425e-02 2.8365586e-04]





169/169 [==============================] - 12s 72ms/step
[1.8202733e-03 1.4674158e-02 1.2819073e-05 7.0915186e-05 6.0808279e-06
 3.8674418e-05 1.1584345e-06 4.0155392e-06 2.9247859e-04 9.5744878e-01]
(5400,)
(5400,)
tf.Tensor(9, shape=(), dtype=int64)
(5400,)
2022-12-27 13:18:02.517812: W tensorflow/core/framework/op_kernel.cc:1830] OP_REQUIRES failed at strided_slice_op.cc:105 : INVALID_ARGUMENT: Index out of range using input dim 0; input has only 0 dims






169/169 [==============================] - 12s 70ms/step
(5400,)